<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="9/24/2015 3:28:08 PM"
  DTS:CreationName="SSIS.Package.3"
  DTS:CreatorComputerName="L19526"
  DTS:CreatorName="AWGPLC\prwarnes"
  DTS:DTSID="{745B476E-7F4C-499E-BAC0-A1D23776CA9F}"
  DTS:ExecutableType="SSIS.Package.3"
  DTS:LastModifiedProductVersion="11.0.6020.0"
  DTS:LocaleID="2057"
  DTS:ObjectName="TWM_SENDCUST"
  DTS:PackageType="5"
  DTS:VersionBuild="4"
  DTS:VersionComments="Updated to SSIS 2012"
  DTS:VersionGUID="{21991FB6-E3A1-4CDA-9554-5DB6B0B91744}"
  DTS:VersionMajor="2">
  <DTS:Property
    DTS:Name="PackageFormatVersion">6</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[RJ]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{72BFE72C-3192-4B75-9013-CB71480EADCB}"
      DTS:ObjectName="RJ">
      <DTS:PropertyExpression
        DTS:Name="InitialCatalog">@[$Package::Database]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="ServerName">@[$Package::Server]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=MUSSQLCLUSTER;Initial Catalog=RJ_SOUTH_TRANSFER;Provider=SQLNCLI11;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[SMTP]"
      DTS:CreationName="SMTP"
      DTS:Description="SMTP"
      DTS:DTSID="{7A1F0067-2CB9-4785-82BB-D4DBBFB50DAF}"
      DTS:ObjectName="SMTP">
      <DTS:ObjectData>
        <SmtpConnectionManager
          ConnectionString="SmtpServer=email.morrisonus.com;UseWindowsAuthentication=False;EnableSsl=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:LogProviders>
    <DTS:LogProvider
      DTS:ConfigString="RJ"
      DTS:CreationName="DTS.LogProviderSQLServer.3"
      DTS:Description="Writes log entries for events to a SQL Server database"
      DTS:DTSID="{F16F867D-DF6A-40C4-921F-76AD27E1B34D}"
      DTS:ObjectName="SSIS log provider for SQL Server">
      <DTS:ObjectData>
        <InnerObject />
      </DTS:ObjectData>
    </DTS:LogProvider>
  </DTS:LogProviders>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{A7601698-126A-42E7-90B1-8E955FCD2C27}"
      DTS:ObjectName="Database"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">RJ_SOUTH_TRANSFER</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{3FBE85DE-FF8C-403B-9D32-1F2400FCDC5D}"
      DTS:ObjectName="EmailBCC"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">paul.warnes@morrisonus.com</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{6CC4E357-EE13-4015-A032-D1BF15AD8F52}"
      DTS:ObjectName="EmailCC"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">paul.warnes@morrisonus.com</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{F853634E-735A-4D07-983E-479FED7B7529}"
      DTS:ObjectName="EmailFrom"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">TWMCustomerFileSender@morrisonus.com</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{828E9435-CB61-4F0D-97A3-20733D8DDEC9}"
      DTS:ObjectName="EmailSubject"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">TWM Customer File Sender results (DO NOT REPLY)</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{AAE511B5-2FC4-4E44-B2CD-21C430D3F35D}"
      DTS:ObjectName="EmailTo"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">paul.warnes@morrisonus.com</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{EEF1FF91-DF55-47D3-8AC6-08665E56B952}"
      DTS:ObjectName="ErrorEmailBody"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">Please call the IT helpdesk on 0870 606 5717 and log this error along with the name of the import routine you have attempted to execute.  In the meantime please do not re-run the routine until you have been advised to do so by Zensar.</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{3000BB06-BA1D-465F-8492-650D1446BFDE}"
      DTS:ObjectName="ErrorEmailMUSTo"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">paul.warnes@morrisonus.com</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{B76BEE43-90E6-4668-B1A6-866FF1630A6C}"
      DTS:ObjectName="ErrorEmailSubject"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">An error has occurred during the execution of this routine</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{30509B0C-AE5D-44CD-839D-4C27962E48A8}"
      DTS:ObjectName="ErrorEmailZensarTo"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">paul.warnes@morrisonus.com</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{77276CED-DDAE-4534-8195-801BF41488D5}"
      DTS:ObjectName="Server"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">MUSSQLCLUSTER</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{17347233-3B0B-46B5-8230-DDDAD3EB85A4}"
      DTS:ObjectName="SFTPAppFolder"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">C:\Program Files\WinSCP</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{2724FC03-226E-40EF-B4A2-4D2378F323AE}"
      DTS:ObjectName="SFTPAppNAme"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">C:\Program Files\WinSCP\WinSCP.exe</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{E8F67938-7745-4DCB-846D-897139398634}"
      DTS:ObjectName="SFTPCatgory"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">CUST_REQ</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{4F1C3940-A065-4A0B-B425-1C8E9B91441B}"
      DTS:ObjectName="SFTPCDCommandForUpload"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">"cd Outbound"</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{CD1CED5F-AEE6-42C2-A8D2-96E13D7EFDC9}"
      DTS:ObjectName="SFTPCloseCommand"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">close exit</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{9AB8DF25-F282-42DA-99BB-777F7819900F}"
      DTS:ObjectName="SFTPCommandStem"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">/CONSOLE   /XMLLOG=</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{07C67751-C885-40A2-A848-349B75BD362D}"
      DTS:ObjectName="SFTPOpenCommand"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue"> /command "Open TW_THAPMPP" </DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{779CA04F-C3C1-49F6-B0AE-E346FDC6E927}"
      DTS:ObjectName="SFTPUploadFileLog"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">E:\ImportRoutineFiles\TWM_JOB_UPDATE\SFTPLogs\SendCustLog.XML</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{D776B70B-70AC-48AC-948F-56D2763225DB}"
      DTS:ObjectName="SFTPUploadFileMask"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">CUSTREQ_*.TXT</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{3E2C7CBF-64E4-4E37-A89F-6497F28A1846}"
      DTS:ObjectName="SFTPUploadPath"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">E:\ImportRoutineFiles\TWM_JOB_UPDATE\SENDTOTW\</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{A9F749F3-94EB-4A69-92C2-7BBB6D74743B}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="EmailBody">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E44C18D6-E2BA-48C4-BAD7-2067F6BC97BF}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="EmailSummary">
      <DTS:VariableValue
        DTS:DataSubType="ManagedSerializable"
        DTS:DataType="13">
        <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
          <SOAP-ENV:Body>
            <xsd:anyType
              id="ref-1"></xsd:anyType>
          </SOAP-ENV:Body>
        </SOAP-ENV:Envelope>
      </DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{777D3A96-C1D2-4756-A99D-033B9032CDAD}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="ErrorEmailBody">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{50522C8D-F693-4561-B3B6-FE4C6BC25100}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="ErrorState">
      <DTS:VariableValue
        DTS:DataType="17">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{19C8C388-50CE-45C3-BC7A-6A2A4E0C10B6}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="FileCount">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{80FC085C-917C-4EAC-8E0D-64F6BF87A7CD}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="FilesToReportOn">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{42050272-B186-4E08-B979-95FC287410B0}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="HeaderFilename">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{926C2409-8681-4E1B-85E7-22A48316814C}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="HeaderStatus">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{5FA2F9A6-D988-4CFD-A7C7-15D469BD5161}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="ReportError">
      <DTS:VariableValue
        DTS:DataType="17">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{584EE75F-A9FF-4224-B74E-ABCD4B59DAF6}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="SFTPFileID">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E2279FCE-F04D-4FF8-BF91-C3D0B75E6876}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SFTPFilename">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E473818C-51F5-494B-B601-E064EBCD418E}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="SFTPFilesToSend">
      <DTS:VariableValue
        DTS:DataSubType="ManagedSerializable"
        DTS:DataType="13">
        <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
          <SOAP-ENV:Body>
            <xsd:anyType
              id="ref-1"></xsd:anyType>
          </SOAP-ENV:Body>
        </SOAP-ENV:Envelope>
      </DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1">
    <DTS:Property
      DTS:DataType="8"
      DTS:Name="EventFilter">1,7,OnError</DTS:Property>
    <DTS:Property
      DTS:EventName="OnError"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:SelectedLogProviders>
      <DTS:SelectedLogProvider
        DTS:InstanceID="{F16F867D-DF6A-40C4-921F-76AD27E1B34D}" />
    </DTS:SelectedLogProviders>
  </DTS:LoggingOptions>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\CountFilesToSFTP"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:DelayValidation="True"
      DTS:Description="CountFilesToSend"
      DTS:DTSID="{63A18339-A8B7-4B7C-8C20-45DCF074C593}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:FailPackageOnFailure="True"
      DTS:FailParentOnFailure="True"
      DTS:LocaleID="-1"
      DTS:ObjectName="CountFilesToSFTP"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server v9; © 2004 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{72BFE72C-3192-4B75-9013-CB71480EADCB}"
          SQLTask:SqlStatementSource="SELECT COUNT(*) FROM SFTPFileSFORTW WHERE StatusCode = 10"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="0"
            SQLTask:DtsVariableName="User::FileCount" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\EmailSummary"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="EmailSummary"
      DTS:DTSID="{1E780F8B-2040-4E78-8BEE-C037A3573019}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="EmailSummary">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\EmailSummary\CountFilesToReportOn"
          DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:DelayValidation="True"
          DTS:Description="CountFilesToReportOn"
          DTS:DTSID="{43B04EBE-3350-4B9F-88EF-4940CDE88ECD}"
          DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:FailPackageOnFailure="True"
          DTS:FailParentOnFailure="True"
          DTS:LocaleID="-1"
          DTS:ObjectName="CountFilesToReportOn"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server v9; © 2004 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="2">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{72BFE72C-3192-4B75-9013-CB71480EADCB}"
              SQLTask:SqlStatementSource="select COUNT(*) from dbo.SFTPFilesForTW where category = 'CUST_REQ'&#xA;and StatusCode BETWEEN -9998 AND 9998"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="0"
                SQLTask:DtsVariableName="User::FilesToReportOn" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\EmailSummary\IterateEmailSummary"
          DTS:CreationName="STOCK:FOREACHLOOP"
          DTS:Description="IterateEmailSummary"
          DTS:DTSID="{4E295294-8D48-4EAB-A563-1406610BA9EC}"
          DTS:ExecutableType="STOCK:FOREACHLOOP"
          DTS:LocaleID="-1"
          DTS:ObjectName="IterateEmailSummary">
          <DTS:ForEachEnumerator
            DTS:CreationName="Microsoft.SqlServer.Dts.Runtime.Enumerators.ADO.ForEachADOEnumerator, Microsoft.SqlServer.ForEachADOEnumerator, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
            DTS:DTSID="{D1E01B04-0DA1-45AA-B190-62F9DCF9AA9D}"
            DTS:ObjectName="{D1E01B04-0DA1-45AA-B190-62F9DCF9AA9D}">
            <DTS:ObjectData>
              <FEEADO
                EnumType="EnumerateRowsInFirstTable"
                VarName="User::EmailSummary" />
            </DTS:ObjectData>
          </DTS:ForEachEnumerator>
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\EmailSummary\IterateEmailSummary\SetEmailBody"
              DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExpressionTask.ExpressionTask, Microsoft.SqlServer.ExpressionTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
              DTS:Description="Expression Task"
              DTS:DTSID="{B799CA0A-FBC7-47BB-95A7-DFF1B5255408}"
              DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExpressionTask.ExpressionTask, Microsoft.SqlServer.ExpressionTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
              DTS:LocaleID="-1"
              DTS:ObjectName="SetEmailBody"
              DTS:TaskContact="Expression Task;Microsoft Corporation; SQL Server 2012; � 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="2">
              <DTS:Variables />
              <DTS:LoggingOptions
                DTS:FilterKind="0" />
              <DTS:ObjectData>
                <ExpressionTask
                  Expression="@[User::EmailBody]= @[User::EmailBody]+ @[User::HeaderFilename]+ @[User::HeaderStatus]+ &quot;\n&quot;" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:ForEachVariableMappings>
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{52EC8EF0-0CBB-4875-AA5B-6E9170F8CA03}"
              DTS:ObjectName="{52EC8EF0-0CBB-4875-AA5B-6E9170F8CA03}"
              DTS:ValueIndex="0"
              DTS:VariableName="User::HeaderFilename" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{2F90E952-4914-482B-8151-F8AC0A224150}"
              DTS:ObjectName="{2F90E952-4914-482B-8151-F8AC0A224150}"
              DTS:ValueIndex="1"
              DTS:VariableName="User::HeaderStatus" />
          </DTS:ForEachVariableMappings>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\EmailSummary\PrepareEmailSummary"
          DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:DelayValidation="True"
          DTS:Description="PrepareSummaryForEmail"
          DTS:DTSID="{8A8D2172-2436-45D8-89E9-6BED0BDBD33D}"
          DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:FailPackageOnFailure="True"
          DTS:FailParentOnFailure="True"
          DTS:LocaleID="-1"
          DTS:ObjectName="PrepareEmailSummary"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server v9; © 2004 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="2">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{72BFE72C-3192-4B75-9013-CB71480EADCB}"
              SQLTask:SqlStatementSource="SELECT&#x9;SFTPFILENAME,&#xA;&#x9;&#x9;STATUS =&#xA;&#x9;&#x9;&#x9;CASE STATUSCODE  &#xA;&#x9;&#x9;&#x9;&#x9;when  -1200 THEN 'FAILED SFTP transfer to TW'&#xA;&#x9;&#x9;&#x9;&#x9;when 1200  THEN 'SUCCESSFUL SFTP transfer to TW'&#xA;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;FROM&#x9;SFTPFilesForTW &#xA;WHERE&#x9;CATEGORY = 'CUST_REQ'&#xA;AND&#x9;&#x9;StatusCode BETWEEN -9998 AND 9998"
              SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="0"
                SQLTask:DtsVariableName="User::EmailSummary" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\EmailSummary\SendNoFilesEmail"
          DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.SendMailTask.SendMailTask, Microsoft.SqlServer.SendMailTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:DelayValidation="True"
          DTS:Description="SendNoFilesEmail"
          DTS:DTSID="{0E65C17A-84D2-48B9-8589-3CD05A202D1E}"
          DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.SendMailTask.SendMailTask, Microsoft.SqlServer.SendMailTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:FailPackageOnFailure="True"
          DTS:FailParentOnFailure="True"
          DTS:LocaleID="-1"
          DTS:ObjectName="SendNoFilesEmail"
          DTS:TaskContact="Send Mail Task; Microsoft Corporation; Microsoft SQL Server v9; © 2004 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="3">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:PropertyExpression
            DTS:Name="BCCLine">@[$Package::EmailBCC]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="CCLine">@[$Package::EmailCC]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="FromLine">@[$Package::EmailFrom]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="Subject">@[$Package::EmailSubject]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="ToLine">@[$Package::EmailTo]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SendMailTask:SendMailTaskData
              SendMailTask:SMTPServer="{7A1F0067-2CB9-4785-82BB-D4DBBFB50DAF}"
              SendMailTask:From="TWMCustomerFileSender@morrisonus.com"
              SendMailTask:To="paul.warnes@morrisonus.com"
              SendMailTask:CC="paul.warnes@morrisonus.com"
              SendMailTask:BCC="paul.warnes@morrisonus.com"
              SendMailTask:Subject="TWM Customer File Sender results (DO NOT REPLY)"
              SendMailTask:MessageSource="The job to send Customer Update files to TW via SFTP has run however no new files were found" xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\EmailSummary\SendSummaryEmail"
          DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.SendMailTask.SendMailTask, Microsoft.SqlServer.SendMailTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:DelayValidation="True"
          DTS:Description="SendSummaryEmail"
          DTS:DTSID="{53A4F730-CEA2-42AF-B1C0-6A35359E7B4E}"
          DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.SendMailTask.SendMailTask, Microsoft.SqlServer.SendMailTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:FailPackageOnFailure="True"
          DTS:FailParentOnFailure="True"
          DTS:LocaleID="-1"
          DTS:ObjectName="SendSummaryEmail"
          DTS:TaskContact="Send Mail Task; Microsoft Corporation; Microsoft SQL Server v9; © 2004 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="2">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:PropertyExpression
            DTS:Name="BCCLine">@[$Package::EmailBCC]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="CCLine">@[$Package::EmailCC]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="FromLine">@[$Package::EmailFrom]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="Subject">@[$Package::EmailSubject]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="ToLine">@[$Package::EmailTo]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SendMailTask:SendMailTaskData
              SendMailTask:SMTPServer="{7A1F0067-2CB9-4785-82BB-D4DBBFB50DAF}"
              SendMailTask:From="TWMCustomerFileSender@morrisonus.com"
              SendMailTask:To="paul.warnes@morrisonus.com"
              SendMailTask:CC="paul.warnes@morrisonus.com"
              SendMailTask:BCC="paul.warnes@morrisonus.com"
              SendMailTask:Subject="TWM Customer File Sender results (DO NOT REPLY)"
              SendMailTask:MessageSourceType="Variable"
              SendMailTask:MessageSource="User::EmailBody" xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\EmailSummary.PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{8F9CE632-1FDF-4184-914F-AF758129371F}"
          DTS:EvalOp="1"
          DTS:Expression="@[User::FilesToReportOn]&gt;0"
          DTS:From="Package\EmailSummary\CountFilesToReportOn"
          DTS:ObjectName="Constraint"
          DTS:To="Package\EmailSummary\PrepareEmailSummary" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\EmailSummary.PrecedenceConstraints[Constraint 1]"
          DTS:CreationName=""
          DTS:DTSID="{50F2B4BB-9E06-4294-B139-3DE852C85ADC}"
          DTS:EvalOp="1"
          DTS:Expression="@[User::FilesToReportOn]==0"
          DTS:From="Package\EmailSummary\CountFilesToReportOn"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 1"
          DTS:To="Package\EmailSummary\SendNoFilesEmail" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\EmailSummary.PrecedenceConstraints[Constraint 2]"
          DTS:CreationName=""
          DTS:DTSID="{13231BCF-57AB-4FAE-9BE1-6749BD98C48D}"
          DTS:From="Package\EmailSummary\PrepareEmailSummary"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 2"
          DTS:To="Package\EmailSummary\IterateEmailSummary" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\EmailSummary.PrecedenceConstraints[Constraint 3]"
          DTS:CreationName=""
          DTS:DTSID="{36DC6136-1671-4C5F-81DF-3C2EB1030639}"
          DTS:From="Package\EmailSummary\IterateEmailSummary"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 3"
          DTS:To="Package\EmailSummary\SendSummaryEmail" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\FindFilesToSendToTW"
      DTS:CreationName="STOCK:FOREACHLOOP"
      DTS:Description="Foreach Loop Container"
      DTS:DTSID="{FBC513F7-5E22-40E6-9C14-985351D82801}"
      DTS:ExecutableType="STOCK:FOREACHLOOP"
      DTS:FailPackageOnFailure="True"
      DTS:FailParentOnFailure="True"
      DTS:LocaleID="-1"
      DTS:ObjectName="FindFilesToSendToTW">
      <DTS:ForEachEnumerator
        DTS:CreationName="DTS.ForEachFileEnumerator.3"
        DTS:DTSID="{E5655A05-F37B-463B-9C23-A7EE0FD8A1E1}"
        DTS:ObjectName="{E5655A05-F37B-463B-9C23-A7EE0FD8A1E1}">
        <DTS:PropertyExpression
          DTS:Name="Directory">@[$Package::SFTPUploadPath]</DTS:PropertyExpression>
        <DTS:PropertyExpression
          DTS:Name="FileSpec">@[$Package::SFTPUploadFileMask]</DTS:PropertyExpression>
        <DTS:ObjectData>
          <ForEachFileEnumeratorProperties>
            <FEFEProperty
              Folder="E:\ImportRoutineFiles\TWM_JOB_UPDATE\SENDTOTW\" />
            <FEFEProperty
              FileSpec="CUSTREQ_*.TXT" />
            <FEFEProperty
              FileNameRetrievalType="0" />
            <FEFEProperty
              Recurse="0" />
          </ForEachFileEnumeratorProperties>
        </DTS:ObjectData>
      </DTS:ForEachEnumerator>
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\FindFilesToSendToTW\AddFileToSFTPFilesForTW"
          DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:DelayValidation="True"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{62A7742B-4604-43F5-AC80-6C5266F99C95}"
          DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:FailPackageOnFailure="True"
          DTS:FailParentOnFailure="True"
          DTS:LocaleID="-1"
          DTS:ObjectName="AddFileToSFTPFilesForTW"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server v9; © 2004 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{72BFE72C-3192-4B75-9013-CB71480EADCB}"
              SQLTask:SqlStatementSource="DECLARE @SFTPCategory varchar(50)&#xA;DECLARE @SFTPFilename&#x9;varchar(255)&#xA;&#xA;SET @SFTPCategory  = ?&#xA;SET @SFTPFilename = ?&#xA;&#xA;&#xA;INSERT INTO [SFTPFilesForTW](Category,SFTPFilename,StatusCode)&#xA;SELECT @SFTPCategory , @SFTPFilename,10&#xA;WHERE&#x9;@SFTPFilename  NOT IN (SELECT SFTPFilename   FROM SFTPFileSFORTW WHERE Category =@SFTPCategory)&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::SFTPFilename"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="$Package::SFTPCatgory"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:ForEachVariableMappings>
        <DTS:ForEachVariableMapping
          DTS:CreationName=""
          DTS:DTSID="{58D5D791-7195-46A7-964E-B8AFECE8DA19}"
          DTS:ObjectName="{58D5D791-7195-46A7-964E-B8AFECE8DA19}"
          DTS:ValueIndex="0"
          DTS:VariableName="User::SFTPFilename" />
      </DTS:ForEachVariableMappings>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\GetFilesToSFTP"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:DelayValidation="True"
      DTS:Description="GetFilesToSFTP"
      DTS:DTSID="{B5C8A437-D949-44D4-929B-0B569FB5440C}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:FailPackageOnFailure="True"
      DTS:FailParentOnFailure="True"
      DTS:LocaleID="-1"
      DTS:ObjectName="GetFilesToSFTP"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server v9; © 2004 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{72BFE72C-3192-4B75-9013-CB71480EADCB}"
          SQLTask:SqlStatementSource="SELECT ID,SFTPFilename FROM SFTPFileSFORTW WHERE StatusCode = 10"
          SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="0"
            SQLTask:DtsVariableName="User::SFTPFilesToSend" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\LoopThroughFilesToUpload"
      DTS:CreationName="STOCK:FOREACHLOOP"
      DTS:Description="Foreach Loop Container"
      DTS:DTSID="{ED2D9C35-A051-43A2-8B82-74A4EEE14071}"
      DTS:ExecutableType="STOCK:FOREACHLOOP"
      DTS:LocaleID="-1"
      DTS:MaxErrorCount="9999"
      DTS:ObjectName="LoopThroughFilesToUpload">
      <DTS:ForEachEnumerator
        DTS:CreationName="Microsoft.SqlServer.Dts.Runtime.Enumerators.ADO.ForEachADOEnumerator, Microsoft.SqlServer.ForEachADOEnumerator, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
        DTS:DTSID="{BB8F1A3E-1FCD-4442-80CD-EBC1B9AA308B}"
        DTS:ObjectName="{BB8F1A3E-1FCD-4442-80CD-EBC1B9AA308B}">
        <DTS:ObjectData>
          <FEEADO
            EnumType="EnumerateRowsInFirstTable"
            VarName="User::SFTPFilesToSend" />
        </DTS:ObjectData>
      </DTS:ForEachEnumerator>
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\LoopThroughFilesToUpload\SendFileToSFTPSite"
          DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteProcess.ExecuteProcess, Microsoft.SqlServer.ExecProcTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:DelayValidation="True"
          DTS:Description="SendFileToSFTPSite"
          DTS:DTSID="{FEC60363-6A10-4775-9C82-A8F87990D23E}"
          DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteProcess.ExecuteProcess, Microsoft.SqlServer.ExecProcTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:LocaleID="-1"
          DTS:ObjectName="SendFileToSFTPSite"
          DTS:TaskContact="Execute Process Task;Microsoft Corporation; Microsoft SQL Server v9; © 2004 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:PropertyExpression
            DTS:Name="Arguments">@[$Package::SFTPCommandStem] + "\"" + @[$Package::SFTPUploadFileLog] + "\"" +  @[$Package::SFTPOpenCommand] + @[$Package::SFTPCDCommandForUpload] + " " + "\"put -transfer=ascii " + @[User::SFTPFilename] + " " + "\"" +  " " + @[$Package::SFTPCloseCommand]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="Executable">@[$Package::SFTPAppNAme]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="WorkingDirectory">@[$Package::SFTPAppFolder]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <ExecuteProcessData
              Executable="C:\Program Files\WinSCP\WinSCP.exe"
              Arguments="/CONSOLE   /XMLLOG=&quot;E:\ImportRoutineFiles\TWM_JOB_UPDATE\SFTPLogs\SendCustLog.XML&quot; /command &quot;Open TW_THAPMPP&quot; &quot;cd Outbound&quot; &quot;put -transfer=ascii  &quot; close exit"
              WorkingDirectory="C:\Program Files\WinSCP" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\LoopThroughFilesToUpload\SFTPSendFailure"
          DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:Description="SFTPSendFailure"
          DTS:DTSID="{FFE804E2-5955-41B2-A6FC-5B5E4E333000}"
          DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:FailPackageOnFailure="True"
          DTS:FailParentOnFailure="True"
          DTS:LocaleID="-1"
          DTS:ObjectName="SFTPSendFailure"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server v9; © 2004 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{72BFE72C-3192-4B75-9013-CB71480EADCB}"
              SQLTask:SqlStatementSource="UPDATE SFTPFilesForTW&#xA;SET&#x9;StatusCode = -1200&#xA;WHERE&#x9;ID = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::SFTPFileID"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\LoopThroughFilesToUpload\SFTPSendSuccess"
          DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:DelayValidation="True"
          DTS:Description="SFTPSendSuccess"
          DTS:DTSID="{17731FCC-0860-48EC-9F5E-4D1CBEBCC260}"
          DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:FailPackageOnFailure="True"
          DTS:FailParentOnFailure="True"
          DTS:LocaleID="-1"
          DTS:ObjectName="SFTPSendSuccess"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server v9; © 2004 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="1">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{72BFE72C-3192-4B75-9013-CB71480EADCB}"
              SQLTask:SqlStatementSource="UPDATE SFTPFilesForTW&#xA;SET&#x9;StatusCode = 1200&#xA;WHERE&#x9;ID = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::SFTPFileID"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\LoopThroughFilesToUpload.PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{AD048686-9E7C-4CC4-A6A0-88C8235414D8}"
          DTS:From="Package\LoopThroughFilesToUpload\SendFileToSFTPSite"
          DTS:ObjectName="Constraint"
          DTS:To="Package\LoopThroughFilesToUpload\SFTPSendSuccess" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\LoopThroughFilesToUpload.PrecedenceConstraints[Constraint 1]"
          DTS:CreationName=""
          DTS:DTSID="{0D15DADA-8FBB-4EA9-8D78-D90381F4A177}"
          DTS:From="Package\LoopThroughFilesToUpload\SendFileToSFTPSite"
          DTS:ObjectName="Constraint 1"
          DTS:To="Package\LoopThroughFilesToUpload\SFTPSendFailure"
          DTS:Value="1" />
      </DTS:PrecedenceConstraints>
      <DTS:ForEachVariableMappings>
        <DTS:ForEachVariableMapping
          DTS:CreationName=""
          DTS:DTSID="{2F28518F-BA3A-4B62-80B3-7B37F323E49F}"
          DTS:ObjectName="{2F28518F-BA3A-4B62-80B3-7B37F323E49F}"
          DTS:ValueIndex="0"
          DTS:VariableName="User::SFTPFileID" />
        <DTS:ForEachVariableMapping
          DTS:CreationName=""
          DTS:DTSID="{157F55F5-C62A-480B-AF31-0A3133CEFA88}"
          DTS:ObjectName="{157F55F5-C62A-480B-AF31-0A3133CEFA88}"
          DTS:ValueIndex="1"
          DTS:VariableName="User::SFTPFilename" />
      </DTS:ForEachVariableMappings>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\SetFinalStatus"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="SetFinalStatus"
      DTS:DTSID="{AF7ACB9C-B98B-4597-B3E2-EB4ABA469C6B}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="SetFinalStatus"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server v9; © 2004 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="2">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{72BFE72C-3192-4B75-9013-CB71480EADCB}"
          SQLTask:SqlStatementSource="&#xA;UPDATE&#x9;SFTPFilesForTW&#xA;SET&#x9;&#x9;StatusCode = 9999 WHERE StatusCode = 1200&#xA;AND&#x9;&#x9;CATEGORY = 'CUST_REQ'&#xA;&#xA;UPDATE&#x9;SFTPFilesForTW&#xA;SET&#x9;&#x9;StatusCode = -9999 WHERE StatusCode = -1200&#xA;AND&#x9;&#x9;CATEGORY = 'CUST_REQ'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{525D1273-E8A5-4383-8466-FD94E63F6304}"
      DTS:From="Package\FindFilesToSendToTW"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\CountFilesToSFTP" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{FF92AD76-4DCC-482C-9CC8-49075EE45533}"
      DTS:EvalOp="1"
      DTS:Expression="@[User::FileCount] &gt; 0"
      DTS:From="Package\CountFilesToSFTP"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\GetFilesToSFTP" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{6F37D13C-2565-4D4E-A836-178B58CA84EE}"
      DTS:From="Package\GetFilesToSFTP"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\LoopThroughFilesToUpload" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{BB57A02F-F0A3-4A02-AA5B-F76F26A04DAB}"
      DTS:From="Package\LoopThroughFilesToUpload"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\EmailSummary" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{0E278D04-22E7-4761-AF98-EEBD3D715F8C}"
      DTS:EvalOp="1"
      DTS:Expression="@[User::FileCount] ==0"
      DTS:From="Package\CountFilesToSFTP"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\EmailSummary" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 5]"
      DTS:CreationName=""
      DTS:DTSID="{79DC1590-4F1B-431E-99FA-AA2BBAC2CE4B}"
      DTS:From="Package\EmailSummary"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 5"
      DTS:To="Package\SetFinalStatus" />
  </DTS:PrecedenceConstraints>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnError]"
      DTS:CreationName="OnError"
      DTS:DTSID="{F1184BA7-45C1-479E-8C61-624FD2C98661}"
      DTS:EventID="0"
      DTS:EventName="OnError"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{5E149021-77B1-448E-BFA1-6711729B30FE}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ErrorState">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{B6F1CC45-25B3-41DB-9EDB-0D391C8DA1DA}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{C214DB20-E74D-426F-874C-97FB1E4CCF91}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="Variable">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\CheckErrorState"
          DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:Description="CheckErrorState"
          DTS:DTSID="{99B24BE7-57F3-4722-93DA-0A315141CCB6}"
          DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:LocaleID="-1"
          DTS:ObjectName="CheckErrorState"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server v9; © 2004 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{72BFE72C-3192-4B75-9013-CB71480EADCB}"
              SQLTask:SqlStatementSource="DECLARE @SourceName VARCHAR(255)&#xA;DECLARE @ErrorState tinyint&#xA;&#xA;SET&#x9;@SourceName = ?&#xA;SET &#x9;@ErrorState = ?&#xA;&#xA;&#xA;IF @ErrorState = 0  AND @SourceName &lt;&gt; 'Import File' &#xA;&#x9;SELECT &#x9;CAST(1 AS TINYINT)&#xA;ELSE &#xA;&#x9;SELECT CAST(0 AS TINYINT)&#xA;"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="0"
                SQLTask:DtsVariableName="User::ReportError" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="System::SourceName"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::ErrorState"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="17"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\SendErrorEmail"
          DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.SendMailTask.SendMailTask, Microsoft.SqlServer.SendMailTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:Description="SendErrorEmail"
          DTS:DTSID="{D1C05310-617D-4B24-8512-820A795357D9}"
          DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.SendMailTask.SendMailTask, Microsoft.SqlServer.SendMailTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:LocaleID="-1"
          DTS:ObjectName="SendErrorEmail"
          DTS:TaskContact="Send Mail Task; Microsoft Corporation; Microsoft SQL Server v9; © 2004 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="BCCLine">@[$Package::ErrorEmailZensarTo]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="FromLine">@[$Package::EmailFrom]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="MessageSource">@[User::EmailBody]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="Subject">@[$Package::ErrorEmailSubject]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="ToLine">@[$Package::ErrorEmailMUSTo]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SendMailTask:SendMailTaskData
              SendMailTask:SMTPServer="{7A1F0067-2CB9-4785-82BB-D4DBBFB50DAF}"
              SendMailTask:From="TWMCustomerFileSender@morrisonus.com"
              SendMailTask:To="paul.warnes@morrisonus.com"
              SendMailTask:BCC="paul.warnes@morrisonus.com"
              SendMailTask:Subject="An error has occurred during the execution of this routine" xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\SetEmailBody"
          DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExpressionTask.ExpressionTask, Microsoft.SqlServer.ExpressionTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:Description="Expression Task"
          DTS:DTSID="{003C8F1C-1BA8-4128-9A21-3F5851621A1E}"
          DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExpressionTask.ExpressionTask, Microsoft.SqlServer.ExpressionTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:LocaleID="-1"
          DTS:ObjectName="SetEmailBody"
          DTS:TaskContact="Expression Task;Microsoft Corporation; SQL Server 2012; � 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:ObjectData>
            <ExpressionTask
              Expression="@[User::ErrorEmailBody]= @[$Package::ErrorEmailBody] +&quot;\n\n&quot; +  &quot;Source : &quot;+@[System::SourceName]+ &quot;\n&quot; + &quot;Error: &quot; +  @[System::ErrorDescription]" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\SetErrorState"
          DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExpressionTask.ExpressionTask, Microsoft.SqlServer.ExpressionTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:Description="Expression Task"
          DTS:DTSID="{85D3487B-059F-477C-A766-CB21F908998E}"
          DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExpressionTask.ExpressionTask, Microsoft.SqlServer.ExpressionTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
          DTS:LocaleID="-1"
          DTS:ObjectName="SetErrorState"
          DTS:TaskContact="Expression Task;Microsoft Corporation; SQL Server 2012; � 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:ObjectData>
            <ExpressionTask
              Expression="@[User::ErrorState]=1" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package.EventHandlers[OnError].PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{3D5546BF-D9EB-42A2-89CC-7BB7D129B67A}"
          DTS:EvalOp="1"
          DTS:Expression="@[User::ReportError]==1"
          DTS:From="Package.EventHandlers[OnError]\CheckErrorState"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package.EventHandlers[OnError]\SetEmailBody" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package.EventHandlers[OnError].PrecedenceConstraints[Constraint 1]"
          DTS:CreationName=""
          DTS:DTSID="{58F26A55-7B11-4579-AB5B-B945F44F0FCB}"
          DTS:From="Package.EventHandlers[OnError]\SetEmailBody"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 1"
          DTS:To="Package.EventHandlers[OnError]\SendErrorEmail" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package.EventHandlers[OnError].PrecedenceConstraints[Constraint 2]"
          DTS:CreationName=""
          DTS:DTSID="{CB40EEF6-E44C-476E-B516-44E3BA7127EE}"
          DTS:From="Package.EventHandlers[OnError]\SendErrorEmail"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 2"
          DTS:To="Package.EventHandlers[OnError]\SetErrorState" />
      </DTS:PrecedenceConstraints>
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="sql11">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="186,44"
          Id="Package\CountFilesToSFTP"
          TopLeft="107.977987421384,200.091194968553" />
        <NodeLayout
          Size="179,44"
          Id="Package\EmailSummary\CountFilesToReportOn"
          TopLeft="142.792452830189,13.9056603773585" />
        <NodeLayout
          Size="145,42"
          Id="Package\EmailSummary\IterateEmailSummary\SetEmailBody"
          TopLeft="75.3333333333335,8.66666666666652" />
        <ContainerLayout
          HeaderHeight="43.924528301886795"
          IsExpanded="True"
          PanelSize="286,73"
          Size="286,117"
          Id="Package\EmailSummary\IterateEmailSummary"
          TopLeft="86.1698113207547,224.584905660377" />
        <NodeLayout
          Size="171,44"
          Id="Package\EmailSummary\PrepareEmailSummary"
          TopLeft="22.9811320754717,107.754716981132" />
        <NodeLayout
          Size="158,44"
          Id="Package\EmailSummary\SendNoFilesEmail"
          TopLeft="246.603773584906,108.735849056604" />
        <NodeLayout
          Size="170,44"
          Id="Package\EmailSummary\SendSummaryEmail"
          TopLeft="144.119496855345,383.96855345912" />
        <EdgeLayout
          Id="Package\EmailSummary.PrecedenceConstraints[Constraint]"
          TopLeft="211.396226415094,57.8301886792453">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-103.056603773585,49.9245283018868"
              Start="0,0"
              End="-103.056603773585,42.4245283018868">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24.9433962264151" />
                  <mssgle:LineSegment
                    End="-103.056603773585,24.9433962264151" />
                  <mssgle:LineSegment
                    End="-103.056603773585,42.4245283018868" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-59.5283018867925,29.9433962264151,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\EmailSummary.PrecedenceConstraints[Constraint 1]"
          TopLeft="252.905660377358,57.8301886792453">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="72.566037735849,50.9056603773585"
              Start="0,0"
              End="72.566037735849,43.4056603773585">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,25.4339622641509" />
                  <mssgle:LineSegment
                    End="72.566037735849,25.4339622641509" />
                  <mssgle:LineSegment
                    End="72.566037735849,43.4056603773585" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="28.2830188679245,30.4339622641509,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\EmailSummary.PrecedenceConstraints[Constraint 2]"
          TopLeft="108.481132075472,151.754716981132">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="120.688679245283,72.830188679245"
              Start="0,0"
              End="120.688679245283,65.330188679245">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,32.4150943396225" />
                  <mssgle:CubicBezierSegment
                    Point1="0,32.4150943396225"
                    Point2="0,36.4150943396225"
                    Point3="4,36.4150943396225" />
                  <mssgle:LineSegment
                    End="116.688679245283,36.4150943396225" />
                  <mssgle:CubicBezierSegment
                    Point1="116.688679245283,36.4150943396225"
                    Point2="120.688679245283,36.4150943396225"
                    Point3="120.688679245283,40.4150943396225" />
                  <mssgle:LineSegment
                    End="120.688679245283,65.330188679245" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\EmailSummary.PrecedenceConstraints[Constraint 3]"
          TopLeft="229.14465408805,341.584905660377">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,42.3836477987427"
              Start="0,0"
              End="0,34.8836477987427">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,34.8836477987427" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43.924528301886795"
          IsExpanded="True"
          PanelSize="433,456"
          Size="433,500"
          Id="Package\EmailSummary"
          TopLeft="630.720125786163,17.6320754716979" />
        <NodeLayout
          Size="193,44"
          Id="Package\FindFilesToSendToTW\AddFileToSFTPFilesForTW"
          TopLeft="24.9433962264151,25.8301886792453" />
        <ContainerLayout
          HeaderHeight="43.924528301886795"
          IsExpanded="True"
          PanelSize="244,93"
          Size="244,137"
          Id="Package\FindFilesToSendToTW"
          TopLeft="81.0345911949684,25.1666666666666" />
        <NodeLayout
          Size="195,44"
          Id="Package\GetFilesToSFTP"
          TopLeft="116.638364779875,310.845911949686" />
        <NodeLayout
          Size="205,44"
          Id="Package\LoopThroughFilesToUpload\SendFileToSFTPSite"
          TopLeft="88.7547169811321,11.4528301886792" />
        <NodeLayout
          Size="161,44"
          Id="Package\LoopThroughFilesToUpload\SFTPSendFailure"
          TopLeft="206.679245283019,87.7924528301887" />
        <NodeLayout
          Size="156,44"
          Id="Package\LoopThroughFilesToUpload\SFTPSendSuccess"
          TopLeft="27.9622641509434,87.7924528301887" />
        <EdgeLayout
          Id="Package\LoopThroughFilesToUpload.PrecedenceConstraints[Constraint]"
          TopLeft="149.584905660377,55.3773584905661">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-43.7735849056604,32.4150943396226"
              Start="0,0"
              End="-43.7735849056604,24.9150943396226">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.188679245283" />
                  <mssgle:LineSegment
                    End="-43.7735849056604,16.188679245283" />
                  <mssgle:LineSegment
                    End="-43.7735849056604,24.9150943396226" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\LoopThroughFilesToUpload.PrecedenceConstraints[Constraint 1]"
          TopLeft="232.603773584906,55.3773584905661">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="54.4528301886793,32.4150943396226"
              Start="0,0"
              End="54.4528301886793,24.9150943396226">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.188679245283" />
                  <mssgle:LineSegment
                    End="54.4528301886793,16.188679245283" />
                  <mssgle:LineSegment
                    End="54.4528301886793,24.9150943396226" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="11.9850674380896,21.188679245283,30.4826953125,9.7490234375"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43.924528301886795"
          IsExpanded="True"
          PanelSize="387,176"
          Size="387,220"
          Id="Package\LoopThroughFilesToUpload"
          TopLeft="10.1666666666665,441.506289308175" />
        <NodeLayout
          Size="136,44"
          Id="Package\SetFinalStatus"
          TopLeft="1248.99056603774,243.533018867925" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="202.006289308175,162.166666666667">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,37.9245283018868"
              Start="0,0"
              End="0,30.4245283018868">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,30.4245283018868" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="200.977987421384,244.091194968554">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="13.1603773584906,66.7547169811321"
              Start="0,0"
              End="13.1603773584906,59.2547169811321">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,29.3773584905662" />
                  <mssgle:CubicBezierSegment
                    Point1="0,29.3773584905662"
                    Point2="0,33.3773584905662"
                    Point3="4,33.3773584905662" />
                  <mssgle:LineSegment
                    End="9.16037735849062,33.3773584905662" />
                  <mssgle:CubicBezierSegment
                    Point1="9.16037735849062,33.3773584905662"
                    Point2="13.1603773584906,33.3773584905662"
                    Point3="13.1603773584906,37.3773584905662" />
                  <mssgle:LineSegment
                    End="13.1603773584906,59.2547169811321" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-1.41981132075469,38.3773584905662,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="214.138364779875,354.845911949686">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-10.4716981132075,86.6603773584907"
              Start="0,0"
              End="-10.4716981132075,79.1603773584907">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,39.3301886792453" />
                  <mssgle:CubicBezierSegment
                    Point1="0,39.3301886792453"
                    Point2="0,43.3301886792453"
                    Point3="-4,43.3301886792453" />
                  <mssgle:LineSegment
                    End="-6.47169811320748,43.3301886792453" />
                  <mssgle:CubicBezierSegment
                    Point1="-6.47169811320748,43.3301886792453"
                    Point2="-10.4716981132075,43.3301886792453"
                    Point3="-10.4716981132075,47.3301886792453" />
                  <mssgle:LineSegment
                    End="-10.4716981132075,79.1603773584907" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="397.166666666667,551.506289308175">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="233.553459119496,-201.874213836478"
              Start="0,0"
              End="226.053459119496,-201.874213836478">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="135.68508320544,0" />
                  <mssgle:CubicBezierSegment
                    Point1="135.68508320544,0"
                    Point2="139.68508320544,0"
                    Point3="139.68508320544,-4" />
                  <mssgle:LineSegment
                    End="139.68508320544,-197.874213836478" />
                  <mssgle:CubicBezierSegment
                    Point1="139.68508320544,-197.874213836478"
                    Point2="139.68508320544,-201.874213836478"
                    Point3="143.68508320544,-201.874213836478" />
                  <mssgle:LineSegment
                    End="226.053459119496,-201.874213836478" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="293.977987421384,222.091194968553">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="336.742138364779,-36.4591194968557"
              Start="0,0"
              End="329.242138364779,-36.4591194968557">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="197.400800457404,0" />
                  <mssgle:CubicBezierSegment
                    Point1="197.400800457404,0"
                    Point2="201.400800457404,0"
                    Point3="201.400800457404,-4" />
                  <mssgle:LineSegment
                    End="201.400800457404,-32.4591194968557" />
                  <mssgle:CubicBezierSegment
                    Point1="201.400800457404,-32.4591194968557"
                    Point2="201.400800457404,-36.4591194968557"
                    Point3="205.400800457404,-36.4591194968557" />
                  <mssgle:LineSegment
                    End="329.242138364779,-36.4591194968557" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="193.400800457404,1,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 5]"
          TopLeft="1063.72012578616,266.582547169811">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="185.270440251573,0"
              Start="0,0"
              End="177.770440251573,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="177.770440251573,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="136,44"
          Id="Package.EventHandlers[OnError]\CheckErrorState"
          TopLeft="99.5,20.5" />
        <NodeLayout
          Size="136,44"
          Id="Package.EventHandlers[OnError]\SendErrorEmail"
          TopLeft="82.4245283018868,281.066037735849" />
        <NodeLayout
          Size="145,42"
          Id="Package.EventHandlers[OnError]\SetEmailBody"
          TopLeft="93,158" />
        <NodeLayout
          Size="144,42"
          Id="Package.EventHandlers[OnError]\SetErrorState"
          TopLeft="80,389" />
        <EdgeLayout
          Id="Package.EventHandlers[OnError].PrecedenceConstraints[Constraint]"
          TopLeft="166.5,64.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,93.5"
              Start="0,0"
              End="0,86">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,86" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-8,35,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.EventHandlers[OnError].PrecedenceConstraints[Constraint 1]"
          TopLeft="165.5,200">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-15.0754716981132,81.066037735849"
              Start="0,0"
              End="-15.0754716981132,73.566037735849">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,36.5330188679245" />
                  <mssgle:CubicBezierSegment
                    Point1="0,36.5330188679245"
                    Point2="0,40.5330188679245"
                    Point3="-4,40.5330188679245" />
                  <mssgle:LineSegment
                    End="-11.0754716981132,40.5330188679245" />
                  <mssgle:CubicBezierSegment
                    Point1="-11.0754716981132,40.5330188679245"
                    Point2="-15.0754716981132,40.5330188679245"
                    Point3="-15.0754716981132,44.5330188679245" />
                  <mssgle:LineSegment
                    End="-15.0754716981132,73.566037735849" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.EventHandlers[OnError].PrecedenceConstraints[Constraint 2]"
          TopLeft="151.212264150943,325.066037735849">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,63.933962264151"
              Start="0,0"
              End="0,56.433962264151">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,56.433962264151" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>